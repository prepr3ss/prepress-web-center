<header class="impact-top-header">
    <div class="impact-top-header-left d-flex align-items-center">
        <!-- Mobile Sidebar Toggle Button -->
        <button class="sidebar-toggle-btn" id="sidebarToggleBtn" aria-label="Toggle sidebar navigation" aria-expanded="false" aria-controls="sidebar-wrapper">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
        </button>
        <img src="{{ url_for('static', filename='img/impact360.png') }}" class="impact-top-logo" alt="Impact 360">
        <span class="impact-top-title">Impact 360</span>
    </div>
    {% if current_user.is_authenticated %}
    <div class="impact-top-header-right">
        <!-- Notification Bell -->
        <div class="dropdown me-3">
            <button class="btn impact-notification-toggle position-relative" type="button" id="notificationDropdown" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Notifications">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                    <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                </svg>
                <span class="notification-badge" id="notificationBadge">0</span>
            </button>
            
            <!-- Notification Dropdown -->
            <ul class="dropdown-menu dropdown-menu-end notification-dropdown" aria-labelledby="notificationDropdown" id="notificationDropdownMenu">
                <li class="notification-dropdown-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">Notifications</h6>
                        <button type="button" class="btn btn-sm btn-link mark-all-read-btn" id="markAllReadBtn">Mark all as read</button>
                    </div>
                </li>
                <li class="notification-list" id="notificationList">
                    <div class="text-center text-muted p-3">
                        <div class="spinner-border spinner-border-sm text-primary me-2" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        Loading notifications...
                    </div>
                </li>
                <li class="notification-dropdown-footer">
                    <a href="/impact/notifications" class="dropdown-item text-center">
                        <small>View all notifications</small>
                    </a>
                </li>
            </ul>
        </div>
        <div class="dropdown">
            <button class="btn impact-user-toggle d-flex align-items-center" type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" class="me-2" aria-hidden="true">
                    <circle cx="12" cy="8" r="3.2" />
                    <path d="M5 20.5c.7-2.8 3.1-4.5 7-4.5s6.3 1.7 7 4.5" />
                </svg>
                <span class="impact-user-name me-1">{{ current_user.name or current_user.username }}</span>
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" class="impact-user-chevron" aria-hidden="true">
                    <polyline points="6 9 12 15 18 9" />
                </svg>
            </button>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                <li>
                    <a class="dropdown-item" href="/impact/settings/change-password">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" class="me-2" aria-hidden="true">
                            <circle cx="7" cy="17" r="2.2" />
                            <path d="M3 17a4 4 0 1 1 7.3-2.2L21 4l1 1-3 3 2 2-1.5 1.5-2-2-2.5 2.5" />
                        </svg>
                        Ganti Password
                    </a>
                </li>
                <li><hr class="dropdown-divider"></li>
                <li>
                    <a class="dropdown-item text-danger" href="{{ url_for('logout') }}">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" class="me-2" aria-hidden="true">
                            <path d="M10 5H6a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h4" />
                            <polyline points="15 17 20 12 15 7" />
                            <line x1="9" y1="12" x2="20" y2="12" />
                        </svg>
                        Logout
                    </a>
                </li>
            </ul>
        </div>
    </div>
    {% endif %}
</header>

<!-- Notification System CSS -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/notification-dropdown.css') }}">

<!-- Notification System JavaScript -->
<script src="{{ url_for('static', filename='js/notification-manager.js') }}"></script>